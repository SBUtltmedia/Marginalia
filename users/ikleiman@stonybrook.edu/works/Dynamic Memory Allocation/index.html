<p>1 word = 4 bytes</p><p>Double word = 8 bytes</p><p>$ gcc -m32 = compiles the program to run on 32 bit systems</p><p>In 32 bit mode malloc returns an address that’s a multiple of 8</p><p>In 64 but mode malloc returns an address that’s a multiple of 16</p><p>Malloc does not initialize memory it allocates</p><p>Calloc initializes memory to 0s.</p><p>Realloc can change the amount of memory previously allocated</p><p>Allocators must follow the stringent constraints of:</p><ul><li>Handling arbitrary request sequences<ul><li>Any order of mallocs and frees</li></ul></li><li>Making immediate responses to requests<ul><li>Means that it is not allowed to re-order or buffer requests for performance</li></ul></li><li>Using only the heap</li><li>Aligning blocks (alignment requirement)<ul><li>Must align blocks in such way that they can hold any type of data object</li></ul></li><li>Not modifying free blocks<ul><li>Allocators can only manipulate or change free blocks<ul><li>Compaction of allocated blocks is not allowed b/c of this</li></ul></li></ul></li></ul><p>Amount of virtual memory is limited by amount of swap space on disk</p><p>Goals:</p><ul><li>Maximize throughput<ul><li>Maximize the amount of allocates and frees you can do in /1sec of time</li></ul></li><li>Maximizing memory utilization</li></ul><p>Internal fragmentation</p><ul><li>When an allocated block’s payload is smaller than the allocated block size… doesn't use the whole blocks potential<ul><li>Allocator may impose a minimum allocate size</li><li>Allocator may allocate a larger block for alignment purposes</li></ul></li></ul><p>External fragmentation</p><ul><li>When there are free blocks, but the free blocks are being wasted because they are too small for what an allocate wants.</li></ul><p>When imposing double-word alignment constraint;</p><ul><li>Block size is a multiple of 8</li><li>8 = …1000<ul><li>The lower 3 bits aren’t used.</li><li>We can use the lower 3 bits to store some information (allocated or not)</li></ul></li></ul><p>Sbrk – ask the kernel for more heap space / virtual memory</p><p>False fragmentation – when there’s lots of small free’d blocks adjacent to each other – such that it makes it unusable.</p><p>Coalescing – merge adjacent free blocks into bigger one</p><p>Immediate coalescing – coalesce free blocks immediately each time free() is called</p><p>Deferred coalescing – coalesce free blocks at some later time</p><ul><li>Might defer coalescing until an allocation request fails</li></ul><p>Thrashing</p><ul><li>Block is repeatedly coalesced then split soon after  </li></ul>